{% extends "base.html" %}

{% block title %}Transport Management{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 mb-0 text-gray-800">
                <i class="fas fa-truck text-primary"></i> ðŸšš Transport & Logistics Management
            </h1>
            <p class="text-muted">Manage transport companies, vehicles, freight, and deliveries</p>
        </div>
        <div>
            <button class="btn btn-primary" onclick="openTransportCompanyModal()">
                <i class="fas fa-plus"></i> New Transport Company
            </button>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="row mb-4">
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-primary shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                Total Companies</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="totalCompanies">0</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-truck fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-success shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                Active Companies</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="activeCompanies">0</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-check-circle fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                Total States</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="totalStates">0</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-map-marker-alt fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-warning shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                Total Cities</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="totalCities">0</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-city fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="row">
        <!-- Recent Companies -->
        <div class="col-lg-8">
            <div class="card shadow mb-4">
                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">Recent Transport Companies</h6>
                    <div class="dropdown no-arrow">
                        <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                            aria-labelledby="dropdownMenuLink">
                            <div class="dropdown-header">Actions:</div>
                            <a class="dropdown-item" href="#" onclick="refreshData()">Refresh</a>
                            <a class="dropdown-item" href="#" onclick="exportData()">Export</a>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="transportTable" width="100%" cellspacing="0">
                            <thead>
                                <tr>
                                    <th>Code</th>
                                    <th>Name</th>
                                    <th>City</th>
                                    <th>State</th>
                                    <th>Status</th>
                                    <th>Commission</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="transportTableBody">
                                <!-- Data will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Top States & Cities -->
        <div class="col-lg-4">
            <!-- Top States -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Top States</h6>
                </div>
                <div class="card-body">
                    <div id="topStatesList">
                        <!-- Top states will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Top Cities -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Top Cities</h6>
                </div>
                <div class="card-body">
                    <div id="topCitiesList">
                        <!-- Top cities will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Transport Company Modal -->
<div class="modal fade" id="transportCompanyModal" tabindex="-1" role="dialog" aria-labelledby="transportCompanyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="transportCompanyModalLabel">New Transport Company</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="transportCompanyForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="transCode">Transport Code *</label>
                                <input type="text" class="form-control" id="transCode" name="trans_cd" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="transName">Transport Name *</label>
                                <input type="text" class="form-control" id="transName" name="trans_nm" required>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label for="address">Address</label>
                                <textarea class="form-control" id="address" name="address" rows="2"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="phone">Phone</label>
                                <input type="text" class="form-control" id="phone" name="phone">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="mobile">Mobile</label>
                                <input type="text" class="form-control" id="mobile" name="mobile">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input type="email" class="form-control" id="email" name="email">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="city">City</label>
                                <input type="text" class="form-control" id="city" name="city">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="state">State</label>
                                <input type="text" class="form-control" id="state" name="state">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="dest">Destination</label>
                                <input type="text" class="form-control" id="dest" name="dest">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="vehicleNo">Vehicle Number</label>
                                <input type="text" class="form-control" id="vehicleNo" name="vehicle_no">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="driverName">Driver Name</label>
                                <input type="text" class="form-control" id="driverName" name="driver_name">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="licenseNo">License Number</label>
                                <input type="text" class="form-control" id="licenseNo" name="license_no">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="gstNo">GST Number</label>
                                <input type="text" class="form-control" id="gstNo" name="gst_no">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="panNo">PAN Number</label>
                                <input type="text" class="form-control" id="panNo" name="pan_no">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="commission">Commission (%)</label>
                                <input type="number" step="0.01" class="form-control" id="commission" name="commission">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="status">Status</label>
                                <select class="form-control" id="status" name="status">
                                    <option value="ACTIVE">Active</option>
                                    <option value="INACTIVE">Inactive</option>
                                    <option value="SUSPENDED">Suspended</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="isActive">Is Active</label>
                                <select class="form-control" id="isActive" name="is_active">
                                    <option value="1">Yes</option>
                                    <option value="0">No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label for="remarks">Remarks</label>
                                <textarea class="form-control" id="remarks" name="remarks" rows="2"></textarea>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveTransportCompany()">Save Company</button>
            </div>
        </div>
    </div>
</div>

<!-- Freight Calculation Modal -->
<div class="modal fade" id="freightModal" tabindex="-1" role="dialog" aria-labelledby="freightModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="freightModalLabel">Freight Charges Calculation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="freightCalculationForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="distance">Distance (km)</label>
                                <input type="number" step="0.1" class="form-control" id="distance" name="distance">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="weight">Weight (kg)</label>
                                <input type="number" step="0.1" class="form-control" id="weight" name="weight">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="volume">Volume (mÂ³)</label>
                                <input type="number" step="0.1" class="form-control" id="volume" name="volume">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="transportType">Transport Type</label>
                                <select class="form-control" id="transportType" name="transport_type">
                                    <option value="road">Road</option>
                                    <option value="rail">Rail</option>
                                    <option value="air">Air</option>
                                    <option value="sea">Sea</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label for="urgency">Urgency</label>
                                <select class="form-control" id="urgency" name="urgency">
                                    <option value="normal">Normal</option>
                                    <option value="express">Express</option>
                                    <option value="urgent">Urgent</option>
                                    <option value="same_day">Same Day</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </form>
                <div id="freightCalculation">
                    <!-- Freight calculation will be displayed here -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="calculateFreight()">Calculate</button>
            </div>
        </div>
    </div>
</div>

<script>
// Global variables
let currentTransportId = null;

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    loadDashboardData();
    setupEventListeners();
});

function setupEventListeners() {
    // Auto-calculate freight when values change
    document.getElementById('distance').addEventListener('input', calculateFreight);
    document.getElementById('weight').addEventListener('input', calculateFreight);
    document.getElementById('volume').addEventListener('input', calculateFreight);
    document.getElementById('transportType').addEventListener('change', calculateFreight);
    document.getElementById('urgency').addEventListener('change', calculateFreight);
}

function loadDashboardData() {
    fetch('/api/transport/dashboard-data')
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateStatistics(data.data.statistics);
                updateRecentCompanies(data.data.recent_companies);
                updateTopStates(data.data.top_states);
                updateTopCities(data.data.top_cities);
            } else {
                showAlert('Error loading dashboard data: ' + data.message, 'danger');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showAlert('Error loading dashboard data', 'danger');
        });
}

function updateStatistics(stats) {
    document.getElementById('totalCompanies').textContent = stats.total_companies || 0;
    document.getElementById('activeCompanies').textContent = stats.active_companies || 0;
    document.getElementById('totalStates').textContent = stats.top_states ? stats.top_states.length : 0;
    document.getElementById('totalCities').textContent = stats.top_cities ? stats.top_cities.length : 0;
}

function updateRecentCompanies(companies) {
    const tbody = document.getElementById('transportTableBody');
    tbody.innerHTML = '';
    
    if (companies.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="text-center">No transport companies found</td></tr>';
        return;
    }
    
    companies.forEach(company => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${company.trans_cd || ''}</td>
            <td>${company.trans_nm || ''}</td>
            <td>${company.city || ''}</td>
            <td>${company.state || ''}</td>
            <td><span class="badge badge-${company.status === 'ACTIVE' ? 'success' : 'warning'}">${company.status || ''}</span></td>
            <td>${(company.commission || 0).toFixed(2)}%</td>
            <td>
                <button class="btn btn-sm btn-info" onclick="viewTransportCompany(${company.id})">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="btn btn-sm btn-warning" onclick="editTransportCompany(${company.id})">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-sm btn-danger" onclick="deleteTransportCompany(${company.id})">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        `;
        tbody.appendChild(row);
    });
}

function updateTopStates(states) {
    const container = document.getElementById('topStatesList');
    container.innerHTML = '';
    
    if (states.length === 0) {
        container.innerHTML = '<p class="text-muted">No states found</p>';
        return;
    }
    
    states.forEach((state, index) => {
        const stateDiv = document.createElement('div');
        stateDiv.className = 'd-flex justify-content-between align-items-center mb-2';
        stateDiv.innerHTML = `
            <div>
                <strong>${state.state || 'Unknown'}</strong>
                <br><small class="text-muted">${state.count} companies</small>
            </div>
            <span class="badge badge-primary">${index + 1}</span>
        `;
        container.appendChild(stateDiv);
    });
}

function updateTopCities(cities) {
    const container = document.getElementById('topCitiesList');
    container.innerHTML = '';
    
    if (cities.length === 0) {
        container.innerHTML = '<p class="text-muted">No cities found</p>';
        return;
    }
    
    cities.forEach((city, index) => {
        const cityDiv = document.createElement('div');
        cityDiv.className = 'd-flex justify-content-between align-items-center mb-2';
        cityDiv.innerHTML = `
            <div>
                <strong>${city.city || 'Unknown'}</strong>
                <br><small class="text-muted">${city.count} companies</small>
            </div>
            <span class="badge badge-success">${index + 1}</span>
        `;
        container.appendChild(cityDiv);
    });
}

function openTransportCompanyModal() {
    currentTransportId = null;
    document.getElementById('transportCompanyForm').reset();
    document.getElementById('transportCompanyModalLabel').textContent = 'New Transport Company';
    $('#transportCompanyModal').modal('show');
}

function saveTransportCompany() {
    const form = document.getElementById('transportCompanyForm');
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    // Convert numeric fields
    if (data.commission) {
        data.commission = parseFloat(data.commission);
    }
    if (data.is_active) {
        data.is_active = parseInt(data.is_active);
    }
    
    const url = currentTransportId ? `/api/transport/company/${currentTransportId}` : '/api/transport/company';
    const method = currentTransportId ? 'PUT' : 'POST';
    
    fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => {
        if (result.success) {
            showAlert(result.message, 'success');
            $('#transportCompanyModal').modal('hide');
            loadDashboardData();
        } else {
            showAlert('Error: ' + result.message, 'danger');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showAlert('Error saving transport company', 'danger');
    });
}

function viewTransportCompany(id) {
    fetch(`/api/transport/company/${id}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                showTransportDetails(data.data);
            } else {
                showAlert('Error loading transport company: ' + data.message, 'danger');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showAlert('Error loading transport company', 'danger');
        });
}

function editTransportCompany(id) {
    fetch(`/api/transport/company/${id}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                currentTransportId = id;
                populateForm(data.data);
                document.getElementById('transportCompanyModalLabel').textContent = 'Edit Transport Company';
                $('#transportCompanyModal').modal('show');
            } else {
                showAlert('Error loading transport company: ' + data.message, 'danger');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showAlert('Error loading transport company', 'danger');
        });
}

function deleteTransportCompany(id) {
    if (confirm('Are you sure you want to delete this transport company?')) {
        fetch(`/api/transport/company/${id}`, {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(result => {
            if (result.success) {
                showAlert(result.message, 'success');
                loadDashboardData();
            } else {
                showAlert('Error: ' + result.message, 'danger');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showAlert('Error deleting transport company', 'danger');
        });
    }
}

function populateForm(data) {
    document.getElementById('transCode').value = data.trans_cd || '';
    document.getElementById('transName').value = data.trans_nm || '';
    document.getElementById('address').value = data.address || '';
    document.getElementById('phone').value = data.phone || '';
    document.getElementById('mobile').value = data.mobile || '';
    document.getElementById('email').value = data.email || '';
    document.getElementById('city').value = data.city || '';
    document.getElementById('state').value = data.state || '';
    document.getElementById('dest').value = data.dest || '';
    document.getElementById('vehicleNo').value = data.vehicle_no || '';
    document.getElementById('driverName').value = data.driver_name || '';
    document.getElementById('licenseNo').value = data.license_no || '';
    document.getElementById('gstNo').value = data.gst_no || '';
    document.getElementById('panNo').value = data.pan_no || '';
    document.getElementById('commission').value = data.commission || '';
    document.getElementById('status').value = data.status || 'ACTIVE';
    document.getElementById('isActive').value = data.is_active ? '1' : '0';
    document.getElementById('remarks').value = data.remarks || '';
}

function openFreightModal() {
    document.getElementById('freightCalculationForm').reset();
    document.getElementById('freightCalculation').innerHTML = '';
    $('#freightModal').modal('show');
}

function calculateFreight() {
    const distance = parseFloat(document.getElementById('distance').value) || 0;
    const weight = parseFloat(document.getElementById('weight').value) || 0;
    const volume = parseFloat(document.getElementById('volume').value) || 0;
    const transportType = document.getElementById('transportType').value;
    const urgency = document.getElementById('urgency').value;
    
    const data = { distance, weight, volume, transport_type: transportType, urgency };
    
    fetch('/api/transport/calculate-freight', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => {
        if (result.success) {
            showFreightCalculation(result.data);
        }
    })
    .catch(error => {
        console.error('Error calculating freight:', error);
    });
}

function showFreightCalculation(charges) {
    const container = document.getElementById('freightCalculation');
    container.innerHTML = `
        <div class="row">
            <div class="col-md-6">
                <p><strong>Distance Charge:</strong> â‚¹${charges.distance_charge}</p>
                <p><strong>Weight Charge:</strong> â‚¹${charges.weight_charge}</p>
                <p><strong>Volume Charge:</strong> â‚¹${charges.volume_charge}</p>
                <p><strong>Base Freight:</strong> â‚¹${charges.base_freight}</p>
            </div>
            <div class="col-md-6">
                <p><strong>Type Multiplier:</strong> ${charges.type_multiplier}x</p>
                <p><strong>Urgency Multiplier:</strong> ${charges.urgency_multiplier}x</p>
                <p><strong>Total Freight:</strong> â‚¹${charges.total_freight}</p>
                <p><strong>Fuel Surcharge:</strong> â‚¹${charges.fuel_surcharge}</p>
                <p><strong>Handling Charge:</strong> â‚¹${charges.handling_charge}</p>
                <p><strong>Insurance Charge:</strong> â‚¹${charges.insurance_charge}</p>
                <hr>
                <p><strong>Grand Total:</strong> â‚¹${charges.grand_total}</p>
            </div>
        </div>
    `;
}

function showTransportDetails(data) {
    const details = `
        <div class="row">
            <div class="col-md-6">
                <p><strong>Code:</strong> ${data.trans_cd}</p>
                <p><strong>Name:</strong> ${data.trans_nm}</p>
                <p><strong>Address:</strong> ${data.address || 'N/A'}</p>
                <p><strong>Phone:</strong> ${data.phone || 'N/A'}</p>
                <p><strong>Mobile:</strong> ${data.mobile || 'N/A'}</p>
                <p><strong>Email:</strong> ${data.email || 'N/A'}</p>
            </div>
            <div class="col-md-6">
                <p><strong>City:</strong> ${data.city || 'N/A'}</p>
                <p><strong>State:</strong> ${data.state || 'N/A'}</p>
                <p><strong>Vehicle No:</strong> ${data.vehicle_no || 'N/A'}</p>
                <p><strong>Driver Name:</strong> ${data.driver_name || 'N/A'}</p>
                <p><strong>Commission:</strong> ${data.commission}%</p>
                <p><strong>Status:</strong> ${data.status}</p>
            </div>
        </div>
    `;
    
    document.getElementById('freightCalculation').innerHTML = details;
    document.getElementById('freightModalLabel').textContent = 'Transport Company Details';
    $('#freightModal').modal('show');
}

function refreshData() {
    loadDashboardData();
    showAlert('Data refreshed successfully', 'success');
}

function exportData() {
    window.open('/api/transport/export', '_blank');
}

function showAlert(message, type) {
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
    alertDiv.innerHTML = `
        ${message}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    `;
    
    const container = document.querySelector('.container-fluid');
    container.insertBefore(alertDiv, container.firstChild);
    
    setTimeout(() => {
        alertDiv.remove();
    }, 5000);
}
</script>
{% endblock %} 